<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Middleware Framwork: middlewareframework/src/main.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Middleware Framwork
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('main_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">main.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="messagebus_8hpp_source.html">core/messagebus.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="PluginManager_8hpp_source.html">Iplugins/PluginManager.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ISensor_8hpp_source.html">sensors/ISensor.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ISensorPlugin_8h_source.html">Iplugins/ISensorPlugin.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="IPlugin_8h_source.html">Iplugins/IPlugin.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Logger_8hpp_source.html">core/Logger.hpp</a>&quot;</code><br />
<code>#include &lt;nlohmann/json.hpp&gt;</code><br />
<code>#include &lt;fstream&gt;</code><br />
<code>#include &lt;thread&gt;</code><br />
<code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &lt;memory&gt;</code><br />
<code>#include &lt;csignal&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for main.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="main_8cpp__incl.png" border="0" usemap="#amiddlewareframework_2src_2main_8cpp" alt=""/></div>
<map name="amiddlewareframework_2src_2main_8cpp" id="amiddlewareframework_2src_2main_8cpp">
<area shape="rect" title=" " alt="" coords="649,5,820,45"/>
<area shape="rect" href="messagebus_8hpp.html" title=" " alt="" coords="297,240,461,265"/>
<area shape="poly" title=" " alt="" coords="649,34,506,46,341,71,264,88,196,110,144,137,126,152,113,168,109,180,113,190,138,208,180,222,284,240,283,245,179,227,136,212,109,194,103,180,108,165,122,148,141,132,194,105,262,83,340,65,505,41,649,28"/>
<area shape="rect" title=" " alt="" coords="199,460,345,485"/>
<area shape="poly" title=" " alt="" coords="649,29,468,36,361,44,255,57,159,76,80,102,50,118,27,136,13,156,8,178,8,327,12,356,25,380,43,400,67,417,125,443,186,458,185,463,123,448,65,422,40,404,20,383,7,357,3,328,3,178,8,154,23,132,47,114,78,97,158,71,255,52,361,38,467,30,649,24"/>
<area shape="rect" title=" " alt="" coords="785,313,847,339"/>
<area shape="poly" title=" " alt="" coords="792,43,824,63,850,92,862,119,867,148,867,177,863,206,848,260,831,302,826,300,843,258,858,205,862,177,862,148,857,121,846,95,821,67,789,48"/>
<area shape="rect" href="PluginManager_8hpp.html" title=" " alt="" coords="634,93,835,119"/>
<area shape="poly" title=" " alt="" coords="737,46,737,79,732,79,732,46"/>
<area shape="rect" title=" " alt="" coords="557,167,635,192"/>
<area shape="poly" title=" " alt="" coords="688,48,654,68,625,95,609,124,602,154,596,152,605,122,621,92,651,63,686,43"/>
<area shape="rect" href="IPlugin_8h.html" title=" " alt="" coords="400,167,533,192"/>
<area shape="poly" title=" " alt="" coords="696,48,604,96,497,161,494,157,601,91,694,43"/>
<area shape="rect" href="ISensor_8hpp.html" title=" " alt="" coords="123,167,274,192"/>
<area shape="poly" title=" " alt="" coords="649,35,552,43,444,56,345,74,306,84,277,96,258,108,242,124,215,156,211,153,238,120,255,104,275,91,305,79,344,68,443,51,551,38,649,30"/>
<area shape="rect" href="ISensorPlugin_8h.html" title=" " alt="" coords="289,93,466,119"/>
<area shape="poly" title=" " alt="" coords="650,48,443,93,442,88,649,43"/>
<area shape="rect" href="Logger_8hpp.html" title=" " alt="" coords="960,93,1085,119"/>
<area shape="poly" title=" " alt="" coords="804,43,968,87,967,92,803,48"/>
<area shape="rect" title=" " alt="" coords="1177,167,1250,192"/>
<area shape="poly" title=" " alt="" coords="821,29,883,36,954,48,1028,66,1098,91,1151,122,1193,155,1190,159,1148,126,1096,96,1026,71,953,53,882,41,820,34"/>
<area shape="rect" title=" " alt="" coords="1160,93,1224,119"/>
<area shape="poly" title=" " alt="" coords="821,37,971,60,1142,91,1147,92,1146,97,1141,96,970,66,820,42"/>
<area shape="rect" title=" " alt="" coords="1248,93,1328,119"/>
<area shape="poly" title=" " alt="" coords="820,33,1007,56,1235,91,1234,96,1006,61,820,39"/>
<area shape="rect" title=" " alt="" coords="1353,93,1421,119"/>
<area shape="poly" title=" " alt="" coords="821,30,1051,51,1193,69,1340,91,1339,96,1193,74,1050,57,820,35"/>
<area shape="rect" title=" " alt="" coords="185,313,247,339"/>
<area shape="poly" title=" " alt="" coords="354,268,256,310,254,305,351,263"/>
<area shape="rect" title=" " alt="" coords="872,313,936,339"/>
<area shape="poly" title=" " alt="" coords="461,258,640,277,859,311,858,316,639,283,461,264"/>
<area shape="rect" title=" " alt="" coords="323,313,466,339"/>
<area shape="poly" title=" " alt="" coords="384,265,392,300,387,301,379,266"/>
<area shape="rect" href="IMessageBus_8hpp.html" title=" " alt="" coords="491,313,659,339"/>
<area shape="poly" title=" " alt="" coords="411,263,531,306,529,311,409,268"/>
<area shape="rect" title=" " alt="" coords="305,387,391,412"/>
<area shape="poly" title=" " alt="" coords="360,268,335,287,314,314,311,330,314,345,330,375,326,377,309,347,306,330,310,312,331,284,356,263"/>
<area shape="poly" title=" " alt="" coords="449,263,771,315,771,320,449,268"/>
<area shape="rect" title=" " alt="" coords="93,313,160,339"/>
<area shape="poly" title=" " alt="" coords="339,268,174,314,173,309,337,263"/>
<area shape="rect" href="messageTypes_8hpp.html" title=" " alt="" coords="531,387,709,412"/>
<area shape="poly" title=" " alt="" coords="584,338,608,374,603,377,580,340"/>
<area shape="poly" title=" " alt="" coords="539,341,399,385,397,380,537,336"/>
<area shape="rect" title=" " alt="" coords="831,460,889,485"/>
<area shape="poly" title=" " alt="" coords="659,409,818,456,817,461,658,415"/>
<area shape="rect" title=" " alt="" coords="587,460,653,485"/>
<area shape="poly" title=" " alt="" coords="623,412,623,446,617,446,617,412"/>
<area shape="poly" title=" " alt="" coords="565,415,342,460,341,455,564,409"/>
<area shape="poly" title=" " alt="" coords="757,117,802,145,857,188,911,244,933,277,951,312,955,333,954,353,938,392,913,426,887,453,883,449,909,423,934,389,948,352,950,333,945,314,929,280,907,248,854,192,799,149,754,121"/>
<area shape="poly" title=" " alt="" coords="754,117,777,137,798,165,811,200,818,237,820,300,815,300,813,238,806,202,794,168,774,141,750,121"/>
<area shape="poly" title=" " alt="" coords="714,121,632,163,630,158,711,116"/>
<area shape="rect" title=" " alt="" coords="659,167,783,192"/>
<area shape="poly" title=" " alt="" coords="735,119,729,154,723,153,730,119"/>
<area shape="poly" title=" " alt="" coords="692,121,524,166,522,161,691,116"/>
<area shape="poly" title=" " alt="" coords="454,194,405,233,402,229,451,190"/>
<area shape="poly" title=" " alt="" coords="534,189,597,207,630,221,660,238,723,288,776,346,819,403,848,447,844,450,815,406,772,350,719,292,657,242,628,226,596,213,533,194"/>
<area shape="poly" title=" " alt="" coords="508,190,572,212,637,246,663,266,679,289,684,314,673,340,657,358,640,370,605,378,565,380,519,389,318,458,316,453,518,384,565,375,604,373,638,365,653,354,668,337,679,313,675,291,659,270,634,250,570,217,507,195"/>
<area shape="poly" title=" " alt="" coords="380,119,381,226,376,226,375,119"/>
<area shape="poly" title=" " alt="" coords="368,121,333,155,287,194,256,214,226,227,172,244,148,254,125,267,104,286,84,315,76,338,80,360,93,380,113,398,166,430,222,453,220,458,164,435,110,403,89,383,75,361,71,338,79,312,100,283,122,262,145,249,170,239,224,222,253,209,284,190,329,151,364,117"/>
<area shape="poly" title=" " alt="" coords="413,116,548,160,547,165,412,121"/>
<area shape="poly" title=" " alt="" coords="393,117,443,156,440,160,390,121"/>
<area shape="poly" title=" " alt="" coords="350,121,241,164,239,159,348,116"/>
<area shape="poly" title=" " alt="" coords="1019,120,944,267,921,303,917,300,939,264,1015,118"/>
<area shape="poly" title=" " alt="" coords="1026,119,1027,251,1027,328,1023,351,1014,373,1000,393,983,410,943,438,903,458,901,453,940,434,980,406,996,389,1009,371,1018,350,1021,327,1021,251,1020,119"/>
<area shape="poly" title=" " alt="" coords="1054,116,1170,159,1168,164,1052,121"/>
<area shape="rect" title=" " alt="" coords="1061,167,1152,192"/>
<area shape="poly" title=" " alt="" coords="1038,117,1084,155,1081,160,1034,121"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae66f6b31b5ad750f1fe042a706a4e3d4" id="r_ae66f6b31b5ad750f1fe042a706a4e3d4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a> ()</td></tr>
<tr class="memdesc:ae66f6b31b5ad750f1fe042a706a4e3d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Entry point of the application.  <br /></td></tr>
<tr class="separator:ae66f6b31b5ad750f1fe042a706a4e3d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aaa2077bc012f57395748161069503a88" id="r_aaa2077bc012f57395748161069503a88"><td class="memItemLeft" align="right" valign="top">volatile std::sig_atomic_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#aaa2077bc012f57395748161069503a88">running</a> = true</td></tr>
<tr class="memdesc:aaa2077bc012f57395748161069503a88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global flag indicating whether the application should keep running.  <br /></td></tr>
<tr class="separator:aaa2077bc012f57395748161069503a88"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ae66f6b31b5ad750f1fe042a706a4e3d4" name="ae66f6b31b5ad750f1fe042a706a4e3d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae66f6b31b5ad750f1fe042a706a4e3d4">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Entry point of the application. </p>
<p>This function:</p><ul>
<li>Registers a signal handler for Ctrl+C (SIGINT).</li>
<li>Loads plugin configuration from a JSON file.</li>
<li>Dynamically loads plugins via the <a class="el" href="classPluginManager.html">PluginManager</a>.</li>
<li>Initializes and starts sensors, loggers, and MQTT adapters.</li>
<li>Runs until SIGINT is received.</li>
<li>Cleans up by stopping sensors and unloading plugins.</li>
</ul>
<dl class="section return"><dt>Returns</dt><dd>int Exit status (0 = success, non-zero = failure). </dd></dl>
<p>&lt; Central message bus for inter-component communication</p>
<p>&lt; Plugin manager responsible for loading/unloading shared libraries</p>
<p>&lt; Container for active sensor instances</p>
<p>&lt; Plugin type identifier</p>
<p>&lt; Filesystem path to the plugin library</p>
<p>Handle Sensor plugin</p>
<p>Casts the base plugin to <a class="el" href="classISensorPlugin.html">ISensorPlugin</a>, creates a sensor instance, and stores it for later startup and shutdown.</p>
<p>Handle <a class="el" href="classLogger.html" title="Thread-safe singleton logger with file output and log rotation.">Logger</a> plugin</p>
<p>Initializes a logger plugin that writes logs internally.</p>
<p>Handle MQTT Adapter plugin</p>
<p>Initializes an MQTT adapter for message bus communication.</p>
<div class="fragment"><div class="line"><span class="lineno">   35</span>           {</div>
<div class="line"><span class="lineno">   36</span>    <span class="comment">// Register SIGINT (Ctrl+C) handler to stop the program</span></div>
<div class="line"><span class="lineno">   37</span>    std::signal(SIGINT, [](<span class="keywordtype">int</span>) { <a class="code hl_variable" href="main_8cpp.html#aaa2077bc012f57395748161069503a88">running</a> = <span class="keyword">false</span>; });</div>
<div class="line"><span class="lineno">   38</span> </div>
<div class="line"><span class="lineno">   39</span>    <a class="code hl_class" href="classMessageBus.html">MessageBus</a> bus;              </div>
<div class="line"><span class="lineno">   40</span>    <a class="code hl_class" href="classPluginManager.html">PluginManager</a> manager;       </div>
<div class="line"><span class="lineno">   41</span> </div>
<div class="line"><span class="lineno">   42</span>    <span class="comment">// -------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">   43</span>    <span class="comment">// Load plugin configuration from JSON file</span></div>
<div class="line"><span class="lineno">   44</span>    <span class="comment">// -------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">   45</span>    nlohmann::json config;</div>
<div class="line"><span class="lineno">   46</span>    std::ifstream file(<span class="stringliteral">&quot;../config/plugins.json&quot;</span>);</div>
<div class="line"><span class="lineno">   47</span>    <span class="keywordflow">if</span> (!file.is_open()) {</div>
<div class="line"><span class="lineno">   48</span>        <a class="code hl_function" href="classLogger.html#a4aa4d7c3b98f6e12e7ea8253da5ea0cd">Logger::instance</a>().<a class="code hl_function" href="classLogger.html#a1267f5b841e1d87b94af5a854460a351">log_error</a>(<span class="stringliteral">&quot;Failed to open config/plugins.json&quot;</span>);</div>
<div class="line"><span class="lineno">   49</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">   50</span>    }</div>
<div class="line"><span class="lineno">   51</span>    file &gt;&gt; config;</div>
<div class="line"><span class="lineno">   52</span>    <a class="code hl_function" href="classLogger.html#a4aa4d7c3b98f6e12e7ea8253da5ea0cd">Logger::instance</a>().<a class="code hl_function" href="classLogger.html#aed90062dee19a7db3236e19845302f6c">log_info</a>(<span class="stringliteral">&quot;Configuration loaded successfully&quot;</span>);</div>
<div class="line"><span class="lineno">   53</span> </div>
<div class="line"><span class="lineno">   54</span>    std::vector&lt;std::unique_ptr&lt;ISensor&gt;&gt; sensors; </div>
<div class="line"><span class="lineno">   55</span> </div>
<div class="line"><span class="lineno">   56</span>    <span class="comment">// -------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">   57</span>    <span class="comment">// Load and initialize plugins dynamically based on config</span></div>
<div class="line"><span class="lineno">   58</span>    <span class="comment">// -------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">   59</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; p : config[<span class="stringliteral">&quot;plugins&quot;</span>]) {</div>
<div class="line"><span class="lineno">   60</span>        <span class="comment">// Skip disabled plugins</span></div>
<div class="line"><span class="lineno">   61</span>        <span class="keywordflow">if</span> (p.value(<span class="stringliteral">&quot;_disabled&quot;</span>, <span class="keyword">false</span>)) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">   62</span> </div>
<div class="line"><span class="lineno">   63</span>        <span class="keyword">const</span> std::string pluginName = p[<span class="stringliteral">&quot;type&quot;</span>];  </div>
<div class="line"><span class="lineno">   64</span>        <span class="keyword">const</span> std::string pluginPath = p[<span class="stringliteral">&quot;path&quot;</span>];  </div>
<div class="line"><span class="lineno">   65</span> </div>
<div class="line"><span class="lineno">   66</span>        <a class="code hl_function" href="classLogger.html#a4aa4d7c3b98f6e12e7ea8253da5ea0cd">Logger::instance</a>().<a class="code hl_function" href="classLogger.html#aed90062dee19a7db3236e19845302f6c">log_info</a>(<span class="stringliteral">&quot;Attempting to load plugin: &quot;</span> + pluginName + </div>
<div class="line"><span class="lineno">   67</span>                                    <span class="stringliteral">&quot; from path: &quot;</span> + pluginPath);</div>
<div class="line"><span class="lineno">   68</span> </div>
<div class="line"><span class="lineno">   69</span>        <span class="comment">// Load shared library</span></div>
<div class="line"><span class="lineno">   70</span>        <span class="keywordflow">if</span> (!manager.<a class="code hl_function" href="classPluginManager.html#a8e407ffe215f71a33f06c4fbb3927445">loadPlugin</a>(pluginPath)) {</div>
<div class="line"><span class="lineno">   71</span>            <a class="code hl_function" href="classLogger.html#a4aa4d7c3b98f6e12e7ea8253da5ea0cd">Logger::instance</a>().<a class="code hl_function" href="classLogger.html#a1267f5b841e1d87b94af5a854460a351">log_error</a>(<span class="stringliteral">&quot;Failed to load plugin library: &quot;</span> + pluginPath);</div>
<div class="line"><span class="lineno">   72</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">   73</span>        }</div>
<div class="line"><span class="lineno">   74</span> </div>
<div class="line"><span class="lineno">   75</span>        <span class="comment">// Retrieve plugin instance</span></div>
<div class="line"><span class="lineno">   76</span>        <a class="code hl_class" href="classIPlugin.html">IPlugin</a>* pluginBase = manager.<a class="code hl_function" href="classPluginManager.html#a610981e564caac0917747ae5fbfa27ce">getPlugin</a>(pluginName);</div>
<div class="line"><span class="lineno">   77</span>        <span class="keywordflow">if</span> (!pluginBase) {</div>
<div class="line"><span class="lineno">   78</span>            <a class="code hl_function" href="classLogger.html#a4aa4d7c3b98f6e12e7ea8253da5ea0cd">Logger::instance</a>().<a class="code hl_function" href="classLogger.html#a1267f5b841e1d87b94af5a854460a351">log_error</a>(<span class="stringliteral">&quot;Failed to get plugin instance: &quot;</span> + pluginName);</div>
<div class="line"><span class="lineno">   79</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">   80</span>        }</div>
<div class="line"><span class="lineno">   81</span> </div>
<div class="line"><span class="lineno">   82</span>        <a class="code hl_function" href="classLogger.html#a4aa4d7c3b98f6e12e7ea8253da5ea0cd">Logger::instance</a>().<a class="code hl_function" href="classLogger.html#aed90062dee19a7db3236e19845302f6c">log_info</a>(<span class="stringliteral">&quot;Successfully loaded plugin: &quot;</span> + pluginName);</div>
<div class="line"><span class="lineno">   83</span> </div>
<div class="line"><span class="lineno">   84</span>        <span class="comment">// Handle plugin types</span></div>
<div class="line"><span class="lineno">   85</span>        <span class="keywordflow">switch</span> (pluginBase-&gt;<a class="code hl_function" href="classIPlugin.html#a7ee4599830505b03a7d54b004bc8643b">getType</a>()) {</div>
<div class="line"><span class="lineno">   86</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="IPlugin_8h.html#a54e0db21fd49ff6e0178b6ebe120a6d2a06b185256c71c1aec263c6e22bf8ef6b">PluginType::Sensor</a>: {</div>
<div class="line"><span class="lineno">   93</span>                <span class="keyword">auto</span>* sensorPlugin = <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="classISensorPlugin.html">ISensorPlugin</a>*<span class="keyword">&gt;</span>(pluginBase);</div>
<div class="line"><span class="lineno">   94</span>                <span class="keywordflow">if</span> (sensorPlugin) {</div>
<div class="line"><span class="lineno">   95</span>                    <span class="keyword">auto</span> sensor = sensorPlugin-&gt;<a class="code hl_function" href="classISensorPlugin.html#ac8dffe7a20e1f3b78c1ff81f41a6c886">createSensor</a>(bus, p[<span class="stringliteral">&quot;config&quot;</span>]);</div>
<div class="line"><span class="lineno">   96</span>                    sensors.push_back(std::move(sensor));</div>
<div class="line"><span class="lineno">   97</span>                    <a class="code hl_function" href="classLogger.html#a4aa4d7c3b98f6e12e7ea8253da5ea0cd">Logger::instance</a>().<a class="code hl_function" href="classLogger.html#aed90062dee19a7db3236e19845302f6c">log_info</a>(<span class="stringliteral">&quot;Sensor plugin initialized: &quot;</span> + pluginName);</div>
<div class="line"><span class="lineno">   98</span>                }</div>
<div class="line"><span class="lineno">   99</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  100</span>            }</div>
<div class="line"><span class="lineno">  101</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="IPlugin_8h.html#a54e0db21fd49ff6e0178b6ebe120a6d2a959112efd77bcbe18a8c9e70e3274220">PluginType::Logger</a>: {</div>
<div class="line"><span class="lineno">  107</span>                pluginBase-&gt;<a class="code hl_function" href="classIPlugin.html#a84cc17d61a111566416bd1b7ba2e0e73">initialize</a>(bus, p[<span class="stringliteral">&quot;config&quot;</span>]);</div>
<div class="line"><span class="lineno">  108</span>                <a class="code hl_function" href="classLogger.html#a4aa4d7c3b98f6e12e7ea8253da5ea0cd">Logger::instance</a>().<a class="code hl_function" href="classLogger.html#aed90062dee19a7db3236e19845302f6c">log_info</a>(<span class="stringliteral">&quot;Logger plugin initialized: &quot;</span> + pluginName);</div>
<div class="line"><span class="lineno">  109</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  110</span>            }</div>
<div class="line"><span class="lineno">  111</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="IPlugin_8h.html#a54e0db21fd49ff6e0178b6ebe120a6d2a6b27cc64d95d6db70d7bbe89fbfb8194">PluginType::MQTTAdapter</a>: {</div>
<div class="line"><span class="lineno">  117</span>                pluginBase-&gt;<a class="code hl_function" href="classIPlugin.html#a84cc17d61a111566416bd1b7ba2e0e73">initialize</a>(bus, p[<span class="stringliteral">&quot;config&quot;</span>]);</div>
<div class="line"><span class="lineno">  118</span>                <a class="code hl_function" href="classLogger.html#a4aa4d7c3b98f6e12e7ea8253da5ea0cd">Logger::instance</a>().<a class="code hl_function" href="classLogger.html#aed90062dee19a7db3236e19845302f6c">log_info</a>(<span class="stringliteral">&quot;MQTT Adapter plugin initialized: &quot;</span> + pluginName);</div>
<div class="line"><span class="lineno">  119</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  120</span>            }</div>
<div class="line"><span class="lineno">  121</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  122</span>                <a class="code hl_function" href="classLogger.html#a4aa4d7c3b98f6e12e7ea8253da5ea0cd">Logger::instance</a>().<a class="code hl_function" href="classLogger.html#acdb09d7375a01c15c80e3b50b06e235b">log_warning</a>(<span class="stringliteral">&quot;Unknown plugin type encountered: &quot;</span> + pluginName);</div>
<div class="line"><span class="lineno">  123</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  124</span>        }</div>
<div class="line"><span class="lineno">  125</span>    }</div>
<div class="line"><span class="lineno">  126</span> </div>
<div class="line"><span class="lineno">  127</span>    <a class="code hl_function" href="classLogger.html#a4aa4d7c3b98f6e12e7ea8253da5ea0cd">Logger::instance</a>().<a class="code hl_function" href="classLogger.html#aed90062dee19a7db3236e19845302f6c">log_info</a>(<span class="stringliteral">&quot;Application started successfully&quot;</span>);</div>
<div class="line"><span class="lineno">  128</span> </div>
<div class="line"><span class="lineno">  129</span>    <span class="comment">// -------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  130</span>    <span class="comment">// Start all sensors</span></div>
<div class="line"><span class="lineno">  131</span>    <span class="comment">// -------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  132</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; s : sensors) {</div>
<div class="line"><span class="lineno">  133</span>        s-&gt;start();</div>
<div class="line"><span class="lineno">  134</span>        <a class="code hl_function" href="classLogger.html#a4aa4d7c3b98f6e12e7ea8253da5ea0cd">Logger::instance</a>().<a class="code hl_function" href="classLogger.html#aed90062dee19a7db3236e19845302f6c">log_info</a>(<span class="stringliteral">&quot;Sensor started&quot;</span>);</div>
<div class="line"><span class="lineno">  135</span>    }</div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>    <span class="comment">// -------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  138</span>    <span class="comment">// Main loop (runs until Ctrl+C is pressed)</span></div>
<div class="line"><span class="lineno">  139</span>    <span class="comment">// -------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  140</span>    <span class="keywordflow">while</span> (<a class="code hl_variable" href="main_8cpp.html#aaa2077bc012f57395748161069503a88">running</a>) {</div>
<div class="line"><span class="lineno">  141</span>        std::this_thread::sleep_for(std::chrono::seconds(1));</div>
<div class="line"><span class="lineno">  142</span>    }</div>
<div class="line"><span class="lineno">  143</span> </div>
<div class="line"><span class="lineno">  144</span>    <a class="code hl_function" href="classLogger.html#a4aa4d7c3b98f6e12e7ea8253da5ea0cd">Logger::instance</a>().<a class="code hl_function" href="classLogger.html#aed90062dee19a7db3236e19845302f6c">log_info</a>(<span class="stringliteral">&quot;Shutdown signal received, stopping sensors...&quot;</span>);</div>
<div class="line"><span class="lineno">  145</span> </div>
<div class="line"><span class="lineno">  146</span>    <span class="comment">// -------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  147</span>    <span class="comment">// Stop all sensors gracefully</span></div>
<div class="line"><span class="lineno">  148</span>    <span class="comment">// -------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  149</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; s : sensors) {</div>
<div class="line"><span class="lineno">  150</span>        s-&gt;stop();</div>
<div class="line"><span class="lineno">  151</span>        <a class="code hl_function" href="classLogger.html#a4aa4d7c3b98f6e12e7ea8253da5ea0cd">Logger::instance</a>().<a class="code hl_function" href="classLogger.html#aed90062dee19a7db3236e19845302f6c">log_info</a>(<span class="stringliteral">&quot;Sensor stopped&quot;</span>);</div>
<div class="line"><span class="lineno">  152</span>    }</div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span>    <span class="comment">// -------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  155</span>    <span class="comment">// Unload all plugins safely</span></div>
<div class="line"><span class="lineno">  156</span>    <span class="comment">// -------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  157</span>    manager.<a class="code hl_function" href="classPluginManager.html#af269b46ab6d5772cde38830169be75ee">unloadAll</a>();</div>
<div class="line"><span class="lineno">  158</span>    <a class="code hl_function" href="classLogger.html#a4aa4d7c3b98f6e12e7ea8253da5ea0cd">Logger::instance</a>().<a class="code hl_function" href="classLogger.html#aed90062dee19a7db3236e19845302f6c">log_info</a>(<span class="stringliteral">&quot;All plugins unloaded, application exiting.&quot;</span>);</div>
<div class="line"><span class="lineno">  159</span> </div>
<div class="line"><span class="lineno">  160</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  161</span>}</div>
<div class="ttc" id="aIPlugin_8h_html_a54e0db21fd49ff6e0178b6ebe120a6d2a06b185256c71c1aec263c6e22bf8ef6b"><div class="ttname"><a href="IPlugin_8h.html#a54e0db21fd49ff6e0178b6ebe120a6d2a06b185256c71c1aec263c6e22bf8ef6b">PluginType::Sensor</a></div><div class="ttdeci">@ Sensor</div></div>
<div class="ttc" id="aIPlugin_8h_html_a54e0db21fd49ff6e0178b6ebe120a6d2a6b27cc64d95d6db70d7bbe89fbfb8194"><div class="ttname"><a href="IPlugin_8h.html#a54e0db21fd49ff6e0178b6ebe120a6d2a6b27cc64d95d6db70d7bbe89fbfb8194">PluginType::MQTTAdapter</a></div><div class="ttdeci">@ MQTTAdapter</div></div>
<div class="ttc" id="aIPlugin_8h_html_a54e0db21fd49ff6e0178b6ebe120a6d2a959112efd77bcbe18a8c9e70e3274220"><div class="ttname"><a href="IPlugin_8h.html#a54e0db21fd49ff6e0178b6ebe120a6d2a959112efd77bcbe18a8c9e70e3274220">PluginType::Logger</a></div><div class="ttdeci">@ Logger</div></div>
<div class="ttc" id="aclassIPlugin_html"><div class="ttname"><a href="classIPlugin.html">IPlugin</a></div><div class="ttdef"><b>Definition</b> IPlugin.h:13</div></div>
<div class="ttc" id="aclassIPlugin_html_a7ee4599830505b03a7d54b004bc8643b"><div class="ttname"><a href="classIPlugin.html#a7ee4599830505b03a7d54b004bc8643b">IPlugin::getType</a></div><div class="ttdeci">virtual PluginType getType() const =0</div></div>
<div class="ttc" id="aclassIPlugin_html_a84cc17d61a111566416bd1b7ba2e0e73"><div class="ttname"><a href="classIPlugin.html#a84cc17d61a111566416bd1b7ba2e0e73">IPlugin::initialize</a></div><div class="ttdeci">virtual void initialize(MessageBus &amp;bus, nlohmann::json &amp;config)=0</div></div>
<div class="ttc" id="aclassISensorPlugin_html"><div class="ttname"><a href="classISensorPlugin.html">ISensorPlugin</a></div><div class="ttdef"><b>Definition</b> ISensorPlugin.h:8</div></div>
<div class="ttc" id="aclassISensorPlugin_html_ac8dffe7a20e1f3b78c1ff81f41a6c886"><div class="ttname"><a href="classISensorPlugin.html#ac8dffe7a20e1f3b78c1ff81f41a6c886">ISensorPlugin::createSensor</a></div><div class="ttdeci">virtual std::unique_ptr&lt; ISensor &gt; createSensor(MessageBus &amp;bus, const nlohmann::json &amp;config)=0</div></div>
<div class="ttc" id="aclassLogger_html_a1267f5b841e1d87b94af5a854460a351"><div class="ttname"><a href="classLogger.html#a1267f5b841e1d87b94af5a854460a351">Logger::log_error</a></div><div class="ttdeci">void log_error(const std::string &amp;msg)</div><div class="ttdoc">Convenience method to log an ERROR message.</div><div class="ttdef"><b>Definition</b> Logger.cpp:108</div></div>
<div class="ttc" id="aclassLogger_html_a4aa4d7c3b98f6e12e7ea8253da5ea0cd"><div class="ttname"><a href="classLogger.html#a4aa4d7c3b98f6e12e7ea8253da5ea0cd">Logger::instance</a></div><div class="ttdeci">static Logger &amp; instance()</div><div class="ttdoc">Get the singleton instance of Logger.</div><div class="ttdef"><b>Definition</b> Logger.cpp:13</div></div>
<div class="ttc" id="aclassLogger_html_acdb09d7375a01c15c80e3b50b06e235b"><div class="ttname"><a href="classLogger.html#acdb09d7375a01c15c80e3b50b06e235b">Logger::log_warning</a></div><div class="ttdeci">void log_warning(const std::string &amp;msg)</div><div class="ttdoc">Convenience method to log a WARNING message.</div><div class="ttdef"><b>Definition</b> Logger.cpp:102</div></div>
<div class="ttc" id="aclassLogger_html_aed90062dee19a7db3236e19845302f6c"><div class="ttname"><a href="classLogger.html#aed90062dee19a7db3236e19845302f6c">Logger::log_info</a></div><div class="ttdeci">void log_info(const std::string &amp;msg)</div><div class="ttdoc">Convenience method to log an INFO message.</div><div class="ttdef"><b>Definition</b> Logger.cpp:96</div></div>
<div class="ttc" id="aclassMessageBus_html"><div class="ttname"><a href="classMessageBus.html">MessageBus</a></div><div class="ttdoc">Thread-safe implementation of IMessageBus using atomic shared_ptr for subscribers.</div><div class="ttdef"><b>Definition</b> messagebus.hpp:19</div></div>
<div class="ttc" id="aclassPluginManager_html"><div class="ttname"><a href="classPluginManager.html">PluginManager</a></div><div class="ttdef"><b>Definition</b> PluginManager.hpp:8</div></div>
<div class="ttc" id="aclassPluginManager_html_a610981e564caac0917747ae5fbfa27ce"><div class="ttname"><a href="classPluginManager.html#a610981e564caac0917747ae5fbfa27ce">PluginManager::getPlugin</a></div><div class="ttdeci">IPlugin * getPlugin(const std::string &amp;name)</div><div class="ttdoc">Retrieve a plugin instance by its name.</div><div class="ttdef"><b>Definition</b> PluginManager.cpp:73</div></div>
<div class="ttc" id="aclassPluginManager_html_a8e407ffe215f71a33f06c4fbb3927445"><div class="ttname"><a href="classPluginManager.html#a8e407ffe215f71a33f06c4fbb3927445">PluginManager::loadPlugin</a></div><div class="ttdeci">bool loadPlugin(const std::string &amp;path)</div><div class="ttdoc">Load a plugin shared library from the specified path.</div><div class="ttdef"><b>Definition</b> PluginManager.cpp:37</div></div>
<div class="ttc" id="aclassPluginManager_html_af269b46ab6d5772cde38830169be75ee"><div class="ttname"><a href="classPluginManager.html#af269b46ab6d5772cde38830169be75ee">PluginManager::unloadAll</a></div><div class="ttdeci">void unloadAll()</div><div class="ttdoc">Unload all plugins and close their shared libraries.</div><div class="ttdef"><b>Definition</b> PluginManager.cpp:89</div></div>
<div class="ttc" id="amain_8cpp_html_aaa2077bc012f57395748161069503a88"><div class="ttname"><a href="main_8cpp.html#aaa2077bc012f57395748161069503a88">running</a></div><div class="ttdeci">volatile std::sig_atomic_t running</div><div class="ttdoc">Global flag indicating whether the application should keep running.</div><div class="ttdef"><b>Definition</b> main.cpp:20</div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="main_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4_cgraph.png" border="0" usemap="#amain_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4_cgraph" alt=""/></div>
<map name="amain_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4_cgraph" id="amain_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4_cgraph">
<area shape="rect" title="Entry point of the application." alt="" coords="5,252,60,277"/>
<area shape="rect" href="classISensorPlugin.html#ac8dffe7a20e1f3b78c1ff81f41a6c886" title=" " alt="" coords="108,5,311,31"/>
<area shape="poly" title=" " alt="" coords="32,252,35,211,45,154,68,93,85,65,106,40,111,36,114,40,110,44,89,68,72,95,50,155,40,211,37,252"/>
<area shape="rect" href="classPluginManager.html#a610981e564caac0917747ae5fbfa27ce" title="Retrieve a plugin instance by its name." alt="" coords="115,55,303,80"/>
<area shape="poly" title=" " alt="" coords="33,251,39,219,52,175,73,129,88,108,106,89,112,85,115,89,110,93,92,111,78,131,57,177,44,220,38,252"/>
<area shape="rect" href="classIPlugin.html#a7ee4599830505b03a7d54b004bc8643b" title=" " alt="" coords="147,104,272,129"/>
<area shape="poly" title=" " alt="" coords="35,251,59,196,80,165,106,139,132,125,134,130,110,143,84,168,64,199,40,253"/>
<area shape="rect" href="classIPlugin.html#a84cc17d61a111566416bd1b7ba2e0e73" title=" " alt="" coords="144,153,275,179"/>
<area shape="poly" title=" " alt="" coords="41,250,68,219,107,188,129,178,131,182,109,192,72,222,45,254"/>
<area shape="rect" href="classLogger.html#a4aa4d7c3b98f6e12e7ea8253da5ea0cd" title="Get the singleton instance of Logger." alt="" coords="145,227,274,252"/>
<area shape="poly" title=" " alt="" coords="60,258,131,248,132,253,60,264"/>
<area shape="rect" href="classPluginManager.html#a8e407ffe215f71a33f06c4fbb3927445" title="Load a plugin shared library from the specified path." alt="" coords="112,276,307,301"/>
<area shape="poly" title=" " alt="" coords="60,266,103,271,102,277,60,271"/>
<area shape="rect" href="classLogger.html#a1267f5b841e1d87b94af5a854460a351" title="Convenience method to log an ERROR message." alt="" coords="143,325,275,351"/>
<area shape="poly" title=" " alt="" coords="52,275,78,293,109,310,133,319,131,324,107,315,75,298,49,280"/>
<area shape="rect" href="classLogger.html#aed90062dee19a7db3236e19845302f6c" title="Convenience method to log an INFO message." alt="" coords="146,375,273,400"/>
<area shape="poly" title=" " alt="" coords="42,276,68,318,87,341,109,360,134,372,131,377,107,364,83,344,64,321,38,279"/>
<area shape="rect" href="classLogger.html#acdb09d7375a01c15c80e3b50b06e235b" title="Convenience method to log a WARNING message." alt="" coords="133,424,286,449"/>
<area shape="poly" title=" " alt="" coords="39,277,47,305,61,341,81,378,110,409,122,417,119,422,106,413,77,381,56,343,42,306,34,278"/>
<area shape="rect" href="classPluginManager.html#af269b46ab6d5772cde38830169be75ee" title="Unload all plugins and close their shared libraries." alt="" coords="115,473,303,499"/>
<area shape="poly" title=" " alt="" coords="38,277,42,313,54,362,76,414,91,438,110,459,117,464,114,469,106,463,87,441,71,417,49,364,37,314,32,278"/>
<area shape="poly" title=" " alt="" coords="180,228,174,218,177,209,189,202,209,200,234,204,244,212,240,216,231,208,209,205,191,207,181,212,179,218,184,225"/>
<area shape="rect" href="classIPlugin.html#a824690d6d94bde40a381ec755832944d" title=" " alt="" coords="359,276,469,301"/>
<area shape="poly" title=" " alt="" coords="307,286,345,286,345,291,307,291"/>
<area shape="rect" href="classLogger.html#abc6c8e85f09a0a2a2650a8c1cb7c275b" title="Log a message with the specified log level." alt="" coords="367,375,461,400"/>
<area shape="poly" title=" " alt="" coords="265,348,311,359,354,370,353,375,310,365,264,353"/>
<area shape="poly" title=" " alt="" coords="273,385,353,385,353,390,273,390"/>
<area shape="poly" title=" " alt="" coords="262,421,353,399,354,404,263,427"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aaa2077bc012f57395748161069503a88" name="aaa2077bc012f57395748161069503a88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa2077bc012f57395748161069503a88">&#9670;&#160;</a></span>running</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile std::sig_atomic_t running = true</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Global flag indicating whether the application should keep running. </p>
<p>Modified by SIGINT (Ctrl+C) signal handler to gracefully stop the program. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_6b8af1f5eee9fdf3b0c4eb0b46d4fa1e.html">middlewareframework</a></li><li class="navelem"><a class="el" href="dir_bde523a8fa200ef93865c29be37215c9.html">src</a></li><li class="navelem"><a class="el" href="main_8cpp.html">main.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
